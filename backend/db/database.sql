-- Create the database if it doesn't already exist.
CREATE DATABASE  water_data_db;

-- Switch to the new database.
USE water_data_db;

-- Drop the table if it exists to ensure a clean start without errors.
DROP TABLE IF EXISTS water_data;

-- Create the refined WATER table.
CREATE TABLE water_data (
    id INT AUTO_INCREMENT PRIMARY KEY,
    state VARCHAR(100) NOT NULL,
    year INT NOT NULL,
    rainfall_mm FLOAT,
    annual_extractable_resources FLOAT,
    groundwater_extraction FLOAT,
    category VARCHAR(20),
    -- Add a unique constraint for state and year to prevent duplicate entries.
    UNIQUE KEY idx_state_year (state, year)
);

-- Insert the data.
INSERT INTO water_data (state, year, rainfall_mm, annual_extractable_resources, groundwater_extraction, category)
VALUES
('Andaman & Nicobar Islands', 2019, 3086.0, 3086000.0, 1543000.0, 'Safe'),
('Andaman & Nicobar Islands', 2020, 2842.9, 2842900.0, 1421450.0, 'Safe'),
('Andaman & Nicobar Islands', 2021, 2842.9, 2842900.0, 1421450.0, 'Safe'),
('Andaman & Nicobar Islands', 2022, 2842.9, 2842900.0, 1421450.0, 'Safe'),
('Andaman & Nicobar Islands', 2023, 2842.9, 2842900.0, 1421450.0, 'Safe'),
('Andaman & Nicobar Islands', 2024, 2842.9, 2842900.0, 1421450.0, 'Safe'),
('Arunachal Pradesh', 2019, 2433.3, 2433300.0, 1216650.0, 'Safe'),
('Arunachal Pradesh', 2020, 2992.9, 2992900.0, 1496450.0, 'Safe'),
('Arunachal Pradesh', 2021, 2992.9, 2992900.0, 1496450.0, 'Safe'),
('Arunachal Pradesh', 2022, 2992.9, 2992900.0, 1496450.0, 'Safe'),
('Arunachal Pradesh', 2023, 2992.9, 2992900.0, 1496450.0, 'Safe'),
('Arunachal Pradesh', 2024, 2992.9, 2992900.0, 1496450.0, 'Safe'),
('Assam', 2019, 2084.7, 2084700.0, 1042350.0, 'Safe'),
('Assam', 2020, 2372.9, 2372900.0, 1186450.0, 'Safe'),
('Assam', 2021, 2372.9, 2372900.0, 1186450.0, 'Safe'),
('Assam', 2022, 2372.9, 2372900.0, 1186450.0, 'Safe'),
('Assam', 2023, 2372.9, 2372900.0, 1186450.0, 'Safe'),
('Assam', 2024, 2372.9, 2372900.0, 1186450.0, 'Safe'),
('Meghalaya', 2019, 3844.4, 3844400.0, 1922200.0, 'Safe'),
('Meghalaya', 2020, 5649.1, 5649100.0, 2824550.0, 'Safe'),
('Meghalaya', 2021, 5649.1, 5649100.0, 2824550.0, 'Safe'),
('Meghalaya', 2022, 5649.1, 5649100.0, 2824550.0, 'Safe'),
('Meghalaya', 2023, 5649.1, 5649100.0, 2824550.0, 'Safe'),
('Meghalaya', 2024, 5649.1, 5649100.0, 2824550.0, 'Safe'),
('Nagaland', 2019, 1593.0, 1593000.0, 796500.0, 'Safe'),
('Nagaland', 2020, 1372.7, 1372700.0, 686350.0, 'Safe'),
('Nagaland', 2021, 1372.7, 1372700.0, 686350.0, 'Safe'),
('Nagaland', 2022, 1372.7, 1372700.0, 686350.0, 'Safe'),
('Nagaland', 2023, 1372.7, 1372700.0, 686350.0, 'Safe'),
('Nagaland', 2024, 1372.7, 1372700.0, 686350.0, 'Safe'),
('Manipur', 2019, 928.6, 928600.0, 464300.0, 'Safe'),
('Manipur', 2020, 1196.9, 1196900.0, 598450.0, 'Safe'),
('Manipur', 2021, 1196.9, 1196900.0, 598450.0, 'Safe'),
('Manipur', 2022, 1196.9, 1196900.0, 598450.0, 'Safe'),
('Manipur', 2023, 1196.9, 1196900.0, 598450.0, 'Safe'),
('Manipur', 2024, 1196.9, 1196900.0, 598450.0, 'Safe'),
('Mizoram', 2019, 2187.5, 2187500.0, 1093750.0, 'Safe'),
('Mizoram', 2020, 1665.2, 1665200.0, 832600.0, 'Safe'),
('Mizoram', 2021, 1665.2, 1665200.0, 832600.0, 'Safe'),
('Mizoram', 2022, 1665.2, 1665200.0, 832600.0, 'Safe'),
('Mizoram', 2023, 1665.2, 1665200.0, 832600.0, 'Safe'),
('Mizoram', 2024, 1665.2, 1665200.0, 832600.0, 'Safe'),
('Tripura', 2019, 2252.8, 2252800.0, 1126400.0, 'Safe'),
('Tripura', 2020, 2169.1, 2169100.0, 1084550.0, 'Safe'),
('Tripura', 2021, 2169.1, 2169100.0, 1084550.0, 'Safe'),
('Tripura', 2022, 2169.1, 2169100.0, 1084550.0, 'Safe'),
('Tripura', 2023, 2169.1, 2169100.0, 1084550.0, 'Safe'),
('Tripura', 2024, 2169.1, 2169100.0, 1084550.0, 'Safe'),
('Sikkim', 2019, 2740.0, 2740000.0, 1370000.0, 'Safe'),
('Sikkim', 2020, 3350.1, 3350100.0, 1675050.0, 'Safe'),
('Sikkim', 2021, 3350.1, 3350100.0, 1675050.0, 'Safe'),
('Sikkim', 2022, 3350.1, 3350100.0, 1675050.0, 'Safe'),
('Sikkim', 2023, 3350.1, 3350100.0, 1675050.0, 'Safe'),
('Sikkim', 2024, 3350.1, 3350100.0, 1675050.0, 'Safe'),
('West Bengal', 2019, 1733.4, 1733400.0, 866700.0, 'Safe'),
('West Bengal', 2020, 2012.6, 2012600.0, 1006300.0, 'Safe'),
('West Bengal', 2021, 2012.6, 2012600.0, 1006300.0, 'Safe'),
('West Bengal', 2022, 2012.6, 2012600.0, 1006300.0, 'Safe'),
('West Bengal', 2023, 2012.6, 2012600.0, 1006300.0, 'Safe'),
('West Bengal', 2024, 2012.6, 2012600.0, 1006300.0, 'Safe'),
('Odisha', 2019, 1393.9, 1393900.0, 696950.0, 'Safe'),
('Odisha', 2020, 1635.9, 1635900.0, 817950.0, 'Safe'),
('Odisha', 2021, 1635.9, 1635900.0, 817950.0, 'Safe'),
('Odisha', 2022, 1635.9, 1635900.0, 817950.0, 'Safe'),
('Odisha', 2023, 1635.9, 1635900.0, 817950.0, 'Safe'),
('Odisha', 2024, 1635.9, 1635900.0, 817950.0, 'Safe'),
('Jharkhand', 2019, 1137.8, 1137800.0, 568900.0, 'Safe'),
('Jharkhand', 2020, 1222.7, 1222700.0, 611350.0, 'Safe'),
('Jharkhand', 2021, 1222.7, 1222700.0, 611350.0, 'Safe'),
('Jharkhand', 2022, 1222.7, 1222700.0, 611350.0, 'Safe'),
('Jharkhand', 2023, 1222.7, 1222700.0, 611350.0, 'Safe'),
('Jharkhand', 2024, 1222.7, 1222700.0, 611350.0, 'Safe'),
('Bihar', 2019, 1194.7, 1194700.0, 597350.0, 'Safe'),
('Bihar', 2020, 1521.4, 1521400.0, 760700.0, 'Safe'),
('Bihar', 2021, 1521.4, 1521400.0, 760700.0, 'Safe'),
('Bihar', 2022, 1521.4, 1521400.0, 760700.0, 'Safe'),
('Bihar', 2023, 1521.4, 1521400.0, 760700.0, 'Safe'),
('Bihar', 2024, 1521.4, 1521400.0, 760700.0, 'Safe'),
('Uttar Pradesh', 2019, 814.5, 814500.0, 651600.0, 'Semi Critical'),
('Uttar Pradesh', 2020, 792.8, 792800.0, 634240.0, 'Semi Critical'),
('Uttar Pradesh', 2021, 792.8, 792800.0, 634240.0, 'Semi Critical'),
('Uttar Pradesh', 2022, 792.8, 792800.0, 634240.0, 'Semi Critical'),
('Uttar Pradesh', 2023, 792.8, 792800.0, 634240.0, 'Semi Critical'),
('Uttar Pradesh', 2024, 792.8, 792800.0, 634240.0, 'Semi Critical'),
('Uttarakhand', 2019, 1378.9, 1378900.0, 1103120.0, 'Semi Critical'),
('Uttarakhand', 2020, 1373.0, 1373000.0, 1098400.0, 'Semi Critical'),
('Uttarakhand', 2021, 1373.0, 1373000.0, 1098400.0, 'Semi Critical'),
('Uttarakhand', 2022, 1373.0, 1373000.0, 1098400.0, 'Semi Critical'),
('Uttarakhand', 2023, 1373.0, 1373000.0, 1098400.0, 'Semi Critical'),
('Uttarakhand', 2024, 1373.0, 1373000.0, 1098400.0, 'Semi Critical'),
('Haryana', 2019, 351.8, 351800.0, 422160.0, 'Over Exploited'),
('Haryana', 2020, 533.2, 533200.0, 639840.0, 'Over Exploited'),
('Haryana', 2021, 533.2, 533200.0, 639840.0, 'Over Exploited'),
('Haryana', 2022, 533.2, 533200.0, 639840.0, 'Over Exploited'),
('Haryana', 2023, 533.2, 533200.0, 639840.0, 'Over Exploited'),
('Haryana', 2024, 533.2, 533200.0, 639840.0, 'Over Exploited'),
('Chandigarh (UT)', 2019, 938.7, 938700.0, 750960.0, 'Semi Critical'),
('Chandigarh (UT)', 2020, 1046.5, 1046500.0, 837200.0, 'Semi Critical'),
('Chandigarh (UT)', 2021, 1046.5, 1046500.0, 837200.0, 'Semi Critical'),
('Chandigarh (UT)', 2022, 1046.5, 1046500.0, 837200.0, 'Semi Critical'),
('Chandigarh (UT)', 2023, 1046.5, 1046500.0, 837200.0, 'Semi Critical'),
('Chandigarh (UT)', 2024, 1046.5, 1046500.0, 837200.0, 'Semi Critical'),
('Delhi', 2019, 546.9, 546900.0, 437520.0, 'Semi Critical'),
('Delhi', 2020, 678.5, 678500.0, 542800.0, 'Semi Critical'),
('Delhi', 2021, 678.5, 678500.0, 542800.0, 'Semi Critical'),
('Delhi', 2022, 678.5, 678500.0, 542800.0, 'Semi Critical'),
('Delhi', 2023, 678.5, 678500.0, 542800.0, 'Semi Critical'),
('Delhi', 2024, 678.5, 678500.0, 542800.0, 'Semi Critical'),
('Punjab', 2019, 653.2, 653200.0, 783840.0, 'Over Exploited'),
('Punjab', 2020, 585.5, 585500.0, 702600.0, 'Over Exploited'),
('Punjab', 2021, 585.5, 585500.0, 702600.0, 'Over Exploited'),
('Punjab', 2022, 585.5, 585500.0, 702600.0, 'Over Exploited'),
('Punjab', 2023, 585.5, 585500.0, 702600.0, 'Over Exploited'),
('Punjab', 2024, 585.5, 585500.0, 702600.0, 'Over Exploited'),
('Himachal Pradesh', 2019, 1217.7, 1217700.0, 608850.0, 'Safe'),
('Himachal Pradesh', 2020, 1052.2, 1052200.0, 526100.0, 'Safe'),
('Himachal Pradesh', 2021, 1052.2, 1052200.0, 526100.0, 'Safe'),
('Himachal Pradesh', 2022, 1052.2, 1052200.0, 526100.0, 'Safe'),
('Himachal Pradesh', 2023, 1052.2, 1052200.0, 526100.0, 'Safe'),
('Himachal Pradesh', 2024, 1052.2, 1052200.0, 526100.0, 'Safe'),
('Jammu & Kashmir', 2019, 1324.1, 1324100.0, 662050.0, 'Safe'),
('Jammu & Kashmir', 2020, 1016.3, 1016300.0, 508150.0, 'Safe'),
('Jammu & Kashmir', 2021, 1016.3, 1016300.0, 508150.0, 'Safe'),
('Jammu & Kashmir', 2022, 1016.3, 1016300.0, 508150.0, 'Safe'),
('Jammu & Kashmir', 2023, 1016.3, 1016300.0, 508150.0, 'Safe'),
('Jammu & Kashmir', 2024, 1016.3, 1016300.0, 508150.0, 'Safe'),
('Rajasthan', 2019, 665.1, 665100.0, 798120.0, 'Over Exploited'),
('Rajasthan', 2020, 24.2, 24200.0, 29040.0, 'Over Exploited'),
('Rajasthan', 2021, 24.2, 24200.0, 29040.0, 'Over Exploited'),
('Rajasthan', 2022, 24.2, 24200.0, 29040.0, 'Over Exploited'),
('Rajasthan', 2023, 24.2, 24200.0, 29040.0, 'Over Exploited'),
('Rajasthan', 2024, 24.2, 24200.0, 29040.0, 'Over Exploited'),
('Madhya Pradesh', 2019, 1446.7, 1446700.0, 1736040.0, 'Over Exploited'),
('Madhya Pradesh', 2020, 511.0, 511000.0, 613200.0, 'Over Exploited'),
('Madhya Pradesh', 2021, 511.0, 511000.0, 613200.0, 'Over Exploited'),
('Madhya Pradesh', 2022, 511.0, 511000.0, 613200.0, 'Over Exploited'),
('Madhya Pradesh', 2023, 511.0, 511000.0, 613200.0, 'Over Exploited'),
('Madhya Pradesh', 2024, 511.0, 511000.0, 613200.0, 'Over Exploited'),
('Gujarat', 2019, 1067.8, 1067800.0, 854240.0, 'Semi Critical'),
('Gujarat', 2020, 1102.2, 1102200.0, 881760.0, 'Semi Critical'),
('Gujarat', 2021, 1102.2, 1102200.0, 881760.0, 'Semi Critical'),
('Gujarat', 2022, 1102.2, 1102200.0, 881760.0, 'Semi Critical'),
('Gujarat', 2023, 1102.2, 1102200.0, 881760.0, 'Semi Critical'),
('Gujarat', 2024, 1102.2, 1102200.0, 881760.0, 'Semi Critical'),
('Dadra & Nagar Haveli (UT)', 2019, 3773.7, 3773700.0, 1886850.0, 'Safe'),
('Dadra & Nagar Haveli (UT)', 2020, 1125.4, 1125400.0, 562700.0, 'Safe'),
('Dadra & Nagar Haveli (UT)', 2021, 1125.4, 1125400.0, 562700.0, 'Safe'),
('Dadra & Nagar Haveli (UT)', 2022, 1125.4, 1125400.0, 562700.0, 'Safe'),
('Dadra & Nagar Haveli (UT)', 2023, 1125.4, 1125400.0, 562700.0, 'Safe'),
('Dadra & Nagar Haveli (UT)', 2024, 1125.4, 1125400.0, 562700.0, 'Safe'),
('Daman & Diu (UT)', 2019, 2270.3, 2270300.0, 1135150.0, 'Safe'),
('Daman & Diu (UT)', 2020, 2413.8, 2413800.0, 1206900.0, 'Safe'),
('Daman & Diu (UT)', 2021, 2413.8, 2413800.0, 1206900.0, 'Safe'),
('Daman & Diu (UT)', 2022, 2413.8, 2413800.0, 1206900.0, 'Safe'),
('Daman & Diu (UT)', 2023, 2413.8, 2413800.0, 1206900.0, 'Safe'),
('Daman & Diu (UT)', 2024, 2413.8, 2413800.0, 1206900.0, 'Safe'),
('Goa', 2019, 4489.5, 4489500.0, 2244750.0, 'Safe'),
('Goa', 2020, 1721.7, 1721700.0, 860850.0, 'Safe'),
('Goa', 2021, 1721.7, 1721700.0, 860850.0, 'Safe'),
('Goa', 2022, 1721.7, 1721700.0, 860850.0, 'Safe'),
('Goa', 2023, 1721.7, 1721700.0, 860850.0, 'Safe'),
('Goa', 2024, 1721.7, 1721700.0, 860850.0, 'Safe'),
('Maharashtra', 2019, 1555.8, 1555800.0, 1244640.0, 'Semi Critical'),
('Maharashtra', 2020, 4406.0, 4406000.0, 3524800.0, 'Semi Critical'),
('Maharashtra', 2021, 4406.0, 4406000.0, 3524800.0, 'Semi Critical'),
('Maharashtra', 2022, 4406.0, 4406000.0, 3524800.0, 'Semi Critical'),
('Maharashtra', 2023, 4406.0, 4406000.0, 3524800.0, 'Semi Critical'),
('Maharashtra', 2024, 4406.0, 4406000.0, 3524800.0, 'Semi Critical'),
('Chhattisgarh', 2019, 1420.3, 1420300.0, 1136240.0, 'Semi Critical'),
('Chhattisgarh', 2020, 1387.4, 1387400.0, 1109920.0, 'Semi Critical'),
('Chhattisgarh', 2021, 1387.4, 1387400.0, 1109920.0, 'Semi Critical'),
('Chhattisgarh', 2022, 1387.4, 1387400.0, 1109920.0, 'Semi Critical'),
('Chhattisgarh', 2023, 1387.4, 1387400.0, 1109920.0, 'Semi Critical'),
('Chhattisgarh', 2024, 1387.4, 1387400.0, 1109920.0, 'Semi Critical'),
('Andhra Pradesh', 2019, 899.2, 899200.0, 719360.0, 'Semi Critical'),
('Andhra Pradesh', 2020, 1515.5, 1515500.0, 1212400.0, 'Semi Critical'),
('Andhra Pradesh', 2021, 1515.5, 1515500.0, 1212400.0, 'Semi Critical'),
('Andhra Pradesh', 2022, 1515.5, 1515500.0, 1212400.0, 'Semi Critical'),
('Andhra Pradesh', 2023, 1515.5, 1515500.0, 1212400.0, 'Semi Critical'),
('Andhra Pradesh', 2024, 1515.5, 1515500.0, 1212400.0, 'Semi Critical'),
('Telangana', 2019, 1031.7, 1031700.0, 825360.0, 'Semi Critical'),
('Telangana', 2020, 1220.5, 1220500.0, 976400.0, 'Semi Critical'),
('Telangana', 2021, 1220.5, 1220500.0, 976400.0, 'Semi Critical'),
('Telangana', 2022, 1220.5, 1220500.0, 976400.0, 'Semi Critical'),
('Telangana', 2023, 1220.5, 1220500.0, 976400.0, 'Semi Critical'),
('Telangana', 2024, 1220.5, 1220500.0, 976400.0, 'Semi Critical'),
('Tamil Nadu', 2019, 910.1, 910100.0, 728080.0, 'Semi Critical'),
('Tamil Nadu', 2020, 1350.3, 1350300.0, 1080240.0, 'Semi Critical'),
('Tamil Nadu', 2021, 1350.3, 1350300.0, 1080240.0, 'Semi Critical'),
('Tamil Nadu', 2022, 1350.3, 1350300.0, 1080240.0, 'Semi Critical'),
('Tamil Nadu', 2023, 1350.3, 1350300.0, 1080240.0, 'Semi Critical'),
('Tamil Nadu', 2024, 1350.3, 1350300.0, 1080240.0, 'Semi Critical'),
('Puducherry (UT)', 2019, 1317.0, 1317000.0, 658500.0, 'Safe'),
('Puducherry (UT)', 2020, 986.2, 986200.0, 493100.0, 'Safe'),
('Puducherry (UT)', 2021, 986.2, 986200.0, 493100.0, 'Safe'),
('Puducherry (UT)', 2022, 986.2, 986200.0, 493100.0, 'Safe'),
('Puducherry (UT)', 2023, 986.2, 986200.0, 493100.0, 'Safe'),
('Puducherry (UT)', 2024, 986.2, 986200.0, 493100.0, 'Safe'),
('Karnataka', 2019, 1422.3, 1422300.0, 1137840.0, 'Semi Critical'),
('Karnataka', 2020, 1693.9, 1693900.0, 1355120.0, 'Semi Critical'),
('Karnataka', 2021, 1693.9, 1693900.0, 1355120.0, 'Semi Critical'),
('Karnataka', 2022, 1693.9, 1693900.0, 1355120.0, 'Semi Critical'),
('Karnataka', 2023, 1693.9, 1693900.0, 1355120.0, 'Semi Critical'),
('Karnataka', 2024, 1693.9, 1693900.0, 1355120.0, 'Semi Critical'),
('Kerala', 2019, 3119.2, 3119200.0, 1559600.0, 'Safe'),
('Kerala', 2020, 1419.1, 1419100.0, 709550.0, 'Safe'),
('Kerala', 2021, 1419.1, 1419100.0, 709550.0, 'Safe'),
('Kerala', 2022, 1419.1, 1419100.0, 709550.0, 'Safe'),
('Kerala', 2023, 1419.1, 1419100.0, 709550.0, 'Safe'),
('Kerala', 2024, 1419.1, 1419100.0, 709550.0, 'Safe'),
('Lakshadweep (UT)', 2019, 2143.0, 2143000.0, 1071500.0, 'Safe'),
('Lakshadweep (UT)', 2020, 2989.7, 2989700.0, 1494850.0, 'Safe'),
('Lakshadweep (UT)', 2021, 2989.7, 2989700.0, 1494850.0, 'Safe'),
('Lakshadweep (UT)', 2022, 2989.7, 2989700.0, 1494850.0, 'Safe'),
('Lakshadweep (UT)', 2023, 2989.7, 2989700.0, 1494850.0, 'Safe'),
('Lakshadweep (UT)', 2024, 2989.7, 2989700.0, 1494850.0, 'Safe');

-- Check if the table was created and data was inserted.
SHOW TABLES;
SELECT * FROM water_data;